<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=1240px" />
    <title>영근 이야기 -영근이야기로 세상을 바꾸다-</title>

    <!-- <link rel="stylesheet" href="../css/index.css" /> -->
    <link rel="stylesheet" href="../css/yg_story.css" />
    <link rel="manifest" href="/favicon/manifest.json?v=87" />

    <meta property="og:site_name" content="영근 이야기에 오신걸 환영합니다." />
  </head>

  <body>
    <div class="header" style="border: 2px solid gold; width: 1240px; height:193px; margin: 0 auto; padding: 0px; align-items: center; display: flex; box-sizing: border-box;">
      <div class="header-left" style="border-right: 2px solid gold; width: 100%; height: 100%;" >
          <img src="../static/images/header_left.gif" alt="헤더 왼쪽 광고" style="width: 100%; height: 100%;" />
      </div>
      <div class="header-center" style="width: 1300px;">
        <div class="catch-phrase" style="font-size: 40px; color: gold; font-weight: bold; text-align: center;">
          <p class="catch-phrase-text"> 인생이 힘들 땐 </p>
        </div>
        <div class="user-info" style="display: flex; justify-content: center; align-items: center; margin-top: 10px;">
          <span id="username-box" class="username" style="margin-right: 10px;">게스트</span>
          <span id="totalCredit" class="credit">보유 크레딧이 없습니다. 충전해 주세요.</span>
        </div>
      </div>
      <div class="header-right" style="border-left: 2px solid gold; width: 100%; height: 100%;">
          <img src="../static/images/header_right.gif" alt="헤더 오른쪽 광고" style="width: 100%; height: 100%;" />
      </div>
    </div>

    <div class="container" style="display: flex; flex-direction: row; align-items: flex-start; padding: 20px 14px;">

      <!-- 왼쪽 사이드바 -->
      <aside class="sidebar-left" style="margin-right: 14px;">
        <div class="sidebar-block highlight-block">
          <div class="new-member-widget" style="border: 2px solid gold;">
            <div class="new-member-header" style="border-bottom: 2px solid gold; padding: 5px 10px; display: flex; align-items: center; justify-content: center;">
              <span class="new-member-header-title" style="margin: 0; text-align: center;">
                신규 (25/07/06)
              </span>
            </div>
                        <!-- 추천: 테이블 구조로 변경 -->
            <div class="new-member-body" style="padding: 10px 20px;">
              <table style="width: 100%; border-collapse: collapse;">
                <tbody>
                  <tr>
                    <td style="font-size: 12px; color: #37ff8b; font-weight: bold;">NEW!</td>
                    <td class="text__yellow winner-nick" style="text-align: left;">이성하</td>
                    <td class="new-member-sum" style="text-align: right;">10,000</td>
                  </tr>
                  <tr>
                    <td style="font-size: 12px; color: #37ff8b; font-weight: bold;">NEW!</td>
                    <td class="text__yellow winner-nick" style="text-align: left;">이웬히</td>
                    <td class="new-member-sum" style="text-align: right;">6,800</td>
                  </tr>
                  <tr>
                    <td style="font-size: 12px; color: #37ff8b; font-weight: bold;">NEW!</td>
                    <td class="text__yellow winner-nick" style="text-align: left;">심남희</td>
                    <td class="new-member-sum" style="text-align: right;">4,360</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
                
        <div class="sidebar-left-banner" style="margin-top: 20px;">
            <img alt="댄스영근" src="../static/images/sidebanner.gif" style="width: 216px; height: 350px; border: 2px solid gold;" /></a>
        
            <div class="green-text" style="margin-top: 10px;">
              <button class="button">
                  <span class="actual-text">&nbsp;&nbsp;영근이야기&nbsp;</span>
                  <span aria-hidden="true" class="hover-text">&nbsp;&nbsp;영근이야기&nbsp;</span>
              </button>
            </div>
        </div>
        </aside>
      <!-- 메인 컨텐츠 -->
      <section class="content-section" style="flex: 1 1 0%;">
        <!-- MAIN CONTENT -->
        <main class="page-content">
            <!-- 메인 배너 -->
                <div class="carousel-inner" role="listbox" style="width: 100%; height: auto; margin-bottom: 20px; border: 2px solid gold; box-sizing: border-box;">
                  <div class="carousel-images" style="width: 100%; height: 100%; line-height: 0;">
                          <img src="../static/images/banner.png" alt="Eldorado" style="width: 100%; height: 100%; object-fit: cover;"/>
                  </div>
                </div>

          <div class="game-room-content" style="padding-bottom: 50px;">
            <div class="games-container on-main" style="border: 2px solid gold;">
              <div style="display: flex; align-items: center; justify-content: space-between; width: 100%;">
                <h2 class="games-title" style="margin-bottom: 0;">게임 리스트</h2>
                  <button type="button"
                    onclick="window.location.href='board.html'"
                    style="padding: 8px 20px; font-size: 20px; border-radius: 8px; background: gold; color: #2d1e3a; font-weight: bold; border: none; cursor: pointer; min-width:90px; white-space:nowrap; display: flex; align-items: center; justify-content: center;">
                    게시판가기
                  </button>
              </div>

              <div class="game" data-gameid="001">
                <div class="game-link">
                  <div class="game-shadow"></div>
                  <a
                    href="#"
                    class="play-btn real no-demo"
                    onclick="startGame('catch_yh.html', '영근이형을 잡아라!')"
                    >바로가기</a
                  >
                  <img
                    src="../static/images/thumnail/thumb_catchyg.png"
                    alt="영근이형을 잡아라"
                  />
                  <span>영근이형을 잡아라!</span>
                </div>
              </div>

              <div class="game" data-gameid="002">
                
                <div class="game-link">
                  <div class="game-shadow"></div>
                  <a
                    href="#"
                    class="play-btn real no-demo"
                    onclick="startGame('make_yh.html', '영근이형 생성기')"
                    >바로가기</a
                  >
                  <img
                    src="../static/images/thumnail/thumb_createyg.png"
                    alt="영근이형 생성기"
                  />
                  <span>영근이형 생성기</span>
                </div>
              </div>

              <div class="game" data-gameid="003">
                <div class="game-link">
                  <div class="game-shadow"></div>
                  <a
                    href="#"
                    class="play-btn real no-demo"
                    onclick="startGame('holjjack.html', '홀·짝 게임')"
                    >바로가기</a
                  >
                  <img
                    src="../static/images/thumnail/thumb_holjjack.png"
                    alt="홀짝"
                  />
                  <span>홀짝</span>
                </div>
              </div>

              <div class="game" data-gameid="004">
              
                <div class="game-link">
                  <div class="game-shadow"></div>
                  <a
                    href="#"
                    class="play-btn real no-demo"
                    onclick="startGame('suika_game.html', '수박게임')"
                    >바로가기</a
                  >
                  <img
                    src="../static/images/thumnail/thumb_suika.png"
                    alt="수박게임"
                  />
                  <span>수박게임</span>
                </div>
              </div>

              <div class="game" data-gameid="005">
                <div class="game-link">
                  <div class="game-shadow"></div>
                  <a
                    href="#"
                    class="play-btn real no-demo"
                    onclick="startGame('bubble_shooter.html', '버블슈터')"
                    >바로가기</a
                  >
                  <img
                    src="../static/images/thumnail/thumb_bubbleshooter.png"
                    alt="버블슈터"
                  />
                  <span>버블슈터</span>
                </div>
              </div>

              <div class="game" data-gameid="006">
                <div class="game-link">
                  <div class="game-shadow"></div>
                  <a
                    href="#"
                    class="play-btn real no-demo"
                    onclick="startGame('slot_machine.html', '슬롯머신')"
                    >바로가기</a
                  >
                  <img
                    src="../static/images/thumnail/thumb_slotmachine.png"
                    alt="슬롯머신"
                  />
                  <span>슬롯머신</span>
                </div>
              </div>

              <div class="game" data-gameid="007">
                <div class="game-link">
                  <div class="game-shadow"></div>
                  <a
                    href="#"
                    class="play-btn real no-demo"
                    onclick="startGame('blackjack.html', '블랙잭')"
                    >바로가기</a
                  >
                  <img
                    src="../static/images/thumnail/thumb_blackjack.png"
                    alt="블랙잭"
                  />
                  <span>블랙잭</span>
                </div>
              </div>

              <div class="game" data-gameid="008">
                <div class="game-link">
                  <div class="game-shadow"></div>
                  <a
                    href="#"
                    class="play-btn real no-demo"
                    onclick="startGame('shell_game.html', '야바위')"
                    >바로가기</a
                  >
                  <img
                    src="../static/images/thumnail/thumb_shell.png"
                    alt="야바위"
                  />
                  <span>야바위</span>
                </div>
              </div>

              <div class="game" data-gameid="009">
                <div class="game-link">
                  <div class="game-shadow"></div>
                  <a
                    href="#"
                    class="play-btn real no-demo"
                    onclick="startGame('different_card.html', '틀린그림 찾기')"
                    >바로가기</a
                  >
                  <img
                    src="../static/images/thumnail/thumb_different.png"
                    alt="틀린영근찾기"
                  />
                  <span>틀린영근찾기</span>
                </div>
              </div>
              
              <div class="game" data-gameid="010">
                <div class="game-link">
                  <div class="game-shadow"></div>
                  <a
                    href="#"
                    class="play-btn real no-demo"
                    onclick="startGame('tower_blocks.html', '타워블록')"
                    >바로가기</a
                  >
                  <img
                    src="../static/images/thumnail/thumb_tower.png"
                    alt="타워블록"
                  />
                  <span>타워블록</span>
                </div>
              </div>

              <div class="game" data-gameid="011">
                <div class="game-link">
                  <div class="game-shadow"></div>
                  <a href="#"
                      class="play-btn real no-demo"
                      onclick="startGame('', '타워블록')"
                    >바로가기</a
                  >
                  <img
                    src="../static/images/thumnail/thumb_spider.png"
                    alt="스파이더 카드게임"
                  />
                  <span>스파이더 카드게임</span>
                </div>
              </div>

              <div class="game" data-gameid="012">
                <div class="game-link">
                  <div class="game-shadow"></div>
                  <a
                    href="https://killedbyapixel.github.io/Drive13K/"
                    class="play-btn real no-demo"
                    >바로가기</a
                  >
                  <img
                    src="../static/images/thumnail/thumb_raicing.png"
                    alt="레이싱게임"
                  />
                  <span>레이싱게임</span>
                </div>
              </div>

              <div class="game" data-gameid="013">
                <div class="game-link">
                  <div class="game-shadow"></div>
                  <a
                    href="https://leokuo0724.github.io/Templar-s-Final-Stand/"
                    class="play-btn real no-demo"
                    >바로가기</a
                  >
                  <img
                    src="../static/images/thumnail/thumb_cardknight.png"
                    alt="카드나이츠"
                  />
                  <span>카드나이츠</span>
                </div>
              </div>

              <div class="game" data-gameid="014">
                <div class="game-link">
                  <div class="game-shadow"></div>
                  <a
                    href="https://play2048.co/"
                    class="play-btn real no-demo"
                    >바로가기</a
                  >
                  <img
                    src="../static/images/thumnail/thumb_2048.png"
                    alt="2048"
                  />
                  <span>2048</span>
                </div>
              </div>

              <div class="game" data-gameid="015">
                <div class="game-link">
                  <div class="game-shadow"></div>
                  <a
                    href="https://mimstris.onrender.com/"
                    class="play-btn real no-demo"
                    >바로가기</a
                  >
                  <img
                    src="../static/images/thumnail/thumb_tetris.png"
                    alt="테트리스"
                  />
                  <span>테트리스</span>
                </div>
              </div>

              <div class="game" data-gameid="016">
                <div class="game-link">
                  <div class="game-shadow"></div>
                  <a
                    href="https://mk.mgechev.com/"
                    class="play-btn real no-demo"
                    >바로가기</a
                  >
                  <img
                    src="../static/images/thumnail/thumb_fight.png"
                    alt="쩝 철권"
                  />
                  <span>짭 철권</span>
                </div>
              </div>

              <div class="game" data-gameid="017">
                <div class="game-link">
                  <div class="game-shadow"></div>
                  <a
                    href="https://openhtml5games.github.io/games-mirror/dist/mariohtml5/main.html"
                    class="play-btn real no-demo"
                    >바로가기</a
                  >
                  <img
                    src="../static/images/thumnail/thumb_mario.png"
                    alt="짭 마리오"
                  />
                  <span>짭 마리오</span>
                </div>
              </div>

              <div class="game" data-gameid="018">
                <div class="game-link">
                  <div class="game-shadow"></div>
                  <a
                    href="https://blog.yjyoon.dev/games/snake.html"
                    class="play-btn real no-demo"
                    >바로가기</a
                  >
                  <img
                    src="../static/images/thumnail/thumb_snake.png"
                    alt="스네이크 게임"
                  />
                  <span>스네이크 게임</span>
                </div>
              </div>

              <!-- Other games list follows similar structure -->
            </div>
          </div>
        </main>
      </section>

      <!-- 오른쪽 사이드바 -->
      <aside class="sidebar-left" style="margin-left: 14px;">
        <div class="sidebar-right-banner" style="margin-bottom: 20px;">
          <img src="../static/images/looking_yh.png" alt="사이드 배너" style="width: 216px; height: 270px; border: 2px solid gold;" /> 
        </div>
        <!-- 원하는 내용 추가 -->
<div class="top-member-widget" style="border: 2px solid gold;">
            <div class="top-member-header" style="border-bottom: 2px solid gold; padding: 5px 10px; display: flex; align-items: center; justify-content: center;">
              <span class="top-member-header-title" style="margin: 0; text-align: center; color: gold;">
                명예의 전당<br/>(25년 7월 5주차)
              </span>
            </div>
                        <!-- 추천: 테이블 구조로 변경 -->
            <div class="top-member-body" style="padding: 10px 20px;">
              <table style="width: 100%; border-collapse: collapse;">
                <thead>
                  <tr>
                    <th style="font-size: 12px; color: gold; font-weight: bold; text-align: left;">순위</th>
                    <th style="font-size: 12px; color: gold; font-weight: bold; text-align: left;">&nbsp;&nbsp;유저</th>
                    <th style="font-size: 12px; color: gold; font-weight: bold; text-align: center;">&nbsp;&nbsp;크레딧</th>
                  </tr>
                </thead>
                <tbody>
                  <tr class="winner">
                    <td style="font-size: 12px; color: gold; font-weight: bold;">1위</td>
                    <td class="text__yellow winner-nick" style="text-align: left;">오동욱</td>
                    <td class="winner-sum" style="text-align: right;">64,926</td>
                  </tr>
                  <tr>
                    <td style="font-size: 12px; color: gold; font-weight: bold;">2위</td>
                    <td class="text__yellow winner-nick" style="text-align: left;">조현우</td>
                    <td class="winner-sum" style="text-align: right;">16,776</td>
                  </tr>
                  <tr>
                    <td style="font-size: 12px; color: gold; font-weight: bold;">3위</td>
                    <td class="text__yellow winner-nick" style="text-align: left;">김창윤</td>
                    <td class="winner-sum" style="text-align: right;">11,901</td>
                  </tr>
                  <tr>
                    <td style="font-size: 12px; color: gold; font-weight: bold;">4위</td>
                    <td class="text__yellow winner-nick" style="text-align: left;">박현재</td>
                    <td class="winner-sum" style="text-align: right;">11,549</td>
                  </tr>
                  <tr>
                    <td style="font-size: 12px; color: gold; font-weight: bold;">5위</td>
                    <td class="text__yellow winner-nick" style="text-align: left;">정지윤</td>
                    <td class="winner-sum" style="text-align: right;">9,473</td>
                  </tr>
                  <tr>
                    <td style="font-size: 12px; color: gold; font-weight: bold;">6위</td>
                    <td class="text__yellow winner-nick" style="text-align: left;">이성하</td>
                    <td class="winner-sum" style="text-align: right;">8,238</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
      </aside>
    </div>
  

    <script>
      // 1. 쿼리스트링 → localStorage 저장
      const params = new URLSearchParams(window.location.search);
      const keys = ['memberId', 'memberName', 'memberCredit', 'memberRole'];

      for (const key of keys) {
        const val = params.get(key);
        if (val && val !== "undefined" && val !== "null") {
          localStorage.setItem(key, val);
        }
      }

      // 2. localStorage에서 정보 불러와서 표시
      const memberName = localStorage.getItem("memberName");
      const memberCredit = localStorage.getItem("memberCredit");

      document.getElementById("username-box").innerText =
              memberName ?? "게스트 :";

      document.getElementById("totalCredit").innerText =
              memberCredit ?? "보유 크레딧이 없습니다. 충전해 주세요.";

      function updateCredits() {
        // 항상 최신 localStorage 값을 기준으로!
        const currentCredits = Number(localStorage.getItem("memberCredit")) || 0;

        // DOM 업데이트
        document.getElementById("totalCredit").innerText = `${currentCredits} 크레딧`;
      }

      // 3. 게임 시작 함수
      function startGame(gameFileName, gameName) {
        const memberId = localStorage.getItem("memberId");
        console.log("확인용 memberId:", memberId);

        if (!memberId || memberId === "null" || memberId === "undefined") {
          alert("로그인 후 이용해주세요.");
          return;
        }

        fetch("/api/game/start", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ memberId, gameName })
        })
                .then(res => {
                  if (!res.ok) throw new Error("크레딧이 부족합니다.");
                  return res.json();
                })
                .then((data) => {

                  localStorage.setItem("memberCredit", data.updatedCredit);
                  credits = data.updatedCredit;
                  updateCredits();
                  window.location.href = gameFileName;
                })
                .catch(err => alert(err.message));
      }

      window.addEventListener("storage", (e) => {
        if (e.key === "memberCredit") {
          document.getElementById("totalCredit").innerText = `${e.newValue} 크레딧`;
        }
      });

    </script>
  </body>
</html>
